#!/usr/bin/env python
# -*- coding: utf-8 -*-
__author__ = 'fly'

import md5py

def hashmd5(predata):
    md5 = md5py.MD5()
    # md5.A = 0x6F70F320
    # md5.B = 0xB0895340
    # md5.C = 0x5609BA31
    # md5.D = 0x997290A3

      # v82 = 0x10325476
      # v81 = 0x98BADCFE
      # v80 = 0xEFCDAB89
      # v83 = 0x67452301

    #md5.count[0] += 0x800
    #7423604ea864b8149261927844ef91041460619900
    #1460619900

    # tmp_salt = [
    #     0x4C, 0x61, 0x4D, 0x65, 0x6C, 0x61, 0x43, 0x6C, 0x69, 0x65, 0x6E, 0x74, 0x65, 0xE0, 0xB9, 0x83,
    #     0xE0, 0xB8, 0x8A, 0xE0, 0xB9, 0x89, 0xE0, 0xB8, 0x82, 0xE0, 0xB8, 0xAD, 0xE0, 0xB8, 0x87, 0xE0,
    #     0xB9, 0x81, 0xE0, 0xB8, 0x97, 0xE0, 0xB9, 0x89, 0xE0, 0xB8, 0xA5, 0xE0, 0xB8, 0xB9, 0xE0, 0xB8,
    #     0x81, 0xE0, 0xB8, 0x84, 0xE0, 0xB9, 0x89, 0xE0, 0xB8, 0xB2, 0xE7, 0x84, 0xA1, 0xE4, 0xBA, 0x8B,
    #     0xE3, 0x81, 0xAB, 0xE8, 0xB3, 0xBC, 0xE5, 0x85, 0xA5, 0x53, 0x65, 0x67, 0x75, 0x72, 0x61, 0x6E,
    #     0xC3, 0xA7, 0x61, 0x70, 0x61, 0x72, 0x61, 0x43, 0x41, 0x53, 0x41, 0xEB, 0x88, 0x84, 0xEA, 0xB0,
    #     0x80, 0xEC, 0x9D, 0xB4, 0xED, 0x95, 0xB4, 0xEC, 0x8B, 0x9C, 0xED, 0x82, 0xA4, 0xEB, 0x8B, 0xA4,
    #     0xEB, 0x88, 0x84, 0xEA, 0xB5, 0xAC, 0xEC, 0xA3, 0xBD, 0xEB, 0x8A, 0x94, 0x52, 0x65, 0x66, 0x75,
    #     0x73, 0x65, 0x72, 0xD0, 0xBA, 0xD0, 0xBE, 0xD1, 0x82, 0xD1, 0x82, 0xD0, 0xB5, 0xD0, 0xB4, 0xD0,
    #     0xB6, 0xD8, 0xA7, 0xD9, 0x84, 0xD8, 0xB9, 0xD9, 0x85, 0xD9, 0x8A, 0xD9, 0x84, 0xE0, 0xB8, 0x84,
    #     0xE0, 0xB8, 0xA3, 0xE0, 0xB8, 0xAD, 0xE0, 0xB8, 0x9A, 0xE0, 0xB8, 0x84, 0xE0, 0xB8, 0xA3, 0xE0,
    #     0xB8, 0xB1, 0xE0, 0xB8, 0xA7, 0xE0, 0xB9, 0x81, 0xE0, 0xB8, 0x95, 0xE0, 0xB8, 0x81, 0xE0, 0xB8,
    #     0x95, 0xE0, 0xB8, 0xB2, 0xE0, 0xB8, 0xA2, 0xD0, 0xBD, 0xD0, 0xBE, 0xD0, 0xB2, 0xD0, 0xB0, 0xD1,
    #     0x8F, 0xD0, 0xB2, 0xD0, 0xB5, 0xD1, 0x80, 0xD1, 0x81, 0xD0, 0xB8, 0xD1, 0x8F
    # ]
    tmp_salt = []
    # print hex(len(tmp_salt))
    for ti in predata:
        tmp_salt.append(ord(ti)),
    # tmp_salt.append(0x80)

    for ti in range(0, len(tmp_salt)):
        tmp_salt[ti] = chr(tmp_salt[ti])
    # 0xE0A2B8E0,0xB8E097B8,0x89B9E0B1,0xE087B8E0,0xB8E084B8,0xADB8E0A3,0xE09AB8E0,0xB8E084B8,0xB1B8E0A3,0xECA7B8E0,0xA1EB8883,0xB49AEC9C,0xEC84B2EB,0x313184A0,0x31313131,0x00000080

    md5.update("".join(tmp_salt))
    # md5.update("7423604ea864b8149261927844ef91041460619900")
    result1 =  md5.hexdigest()
    result2 = ""
    for i in range(24, 32):
        result2 += result1[i]
    for i in range(8, 24):
        result2 += result1[i]
    for i in range(0, 8):
        result2 += result1[i]
    return result2